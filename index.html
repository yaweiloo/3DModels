<!doctype html>
<html>
   <head>
      <meta charset = "utf-8">
      <title>3D box</title>
      <!-- <script src = "babylon.js"></script> -->
      <script src="https://cdn.babylonjs.com/babylon.js"></script>
      <script src="https://cdn.babylonjs.com/babylon.max.js"></script>
      <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
      <script src="https://code.jquery.com/pep/0.4.3/pep.js"></script>
      <style>
         canvas {width: 100%; height: 100%;}
      </style>
   </head>
   
   <body>
      <canvas id = "renderCanvas"></canvas>
      <script type = "text/javascript">
         var canvas = document.getElementById("renderCanvas");
         var engine = new BABYLON.Engine(canvas, true);
         var createScene  = function() {
            var scene = new BABYLON.Scene(engine);
            scene.clearColor = new BABYLON.Color3(1, 1.0, 1.0);
            // var camera = new BABYLON.ArcRotateCamera("Camera", Math.PI / 2, Math.PI / 2, 2, new BABYLON.Vector3(0,0,0), scene);
            var camera = new BABYLON.ArcRotateCamera("Camera", 3 * Math.PI / 2, Math.PI / 2, 10, BABYLON.Vector3.Zero(), scene);
            camera.attachControl(canvas, true);
            camera.minZ = 0.1;
            camera.maxZ = 1000;
            camera.lowerRadiusLimit = 0.1;
            camera.upperRadiusLimit = 15;
            camera.wheelPrecision = 50;
            // Add lights to the scene
            var light1 = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
            var light2 = new BABYLON.PointLight("light2", new BABYLON.Vector3(0, 0, 5), scene);

            // Add and manipulate meshes in the scene
            // var sphere = BABYLON.MeshBuilder.CreateSphere("sphere", {diameter:2}, scene);
            // var camera = new BABYLON.ArcRotateCamera("Camera", 1, 0.8, 10, new BABYLON.Vector3(0, 0, 0), scene);
            // var light0 = new BABYLON.PointLight("Omni", new BABYLON.Vector3(0, 0, 10), scene);
             var sphere = BABYLON.Mesh.CreateSphere("origin", 36, 2.0, scene);
             sphere.position = new BABYLON.Vector3(-5, 0, 0);
            sphere.scaling.y = -1
            sphere.scaling.x = -1
            sphere.rotation = new BABYLON.Vector3(0, Math.PI, 0);
            
            // Create material from image with alpha
            var material0 = new BABYLON.StandardMaterial("girl", scene);
            // mat.diffuseTexture = new BABYLON.Texture("https://upload.wikimedia.org/wikipedia/commons/8/87/Alaskan_Malamute%2BBlank.png", scene);
            material0.emissiveTexture = material0.diffuseTexture = new BABYLON.Texture("https://upload.wikimedia.org/wikipedia/commons/f/fe/Az_girl_with_flowers._e-citizen.jpg", scene);
            // mat.diffuseTexture.hasAlpha = false;
            // mat.backFaceCulling = false;
            var box = BABYLON.Mesh.CreateBox("box", 2.0, scene);
            box.position = new BABYLON.Vector3(5, 0, 0); 
            box.scaling.x = 800/450
            box.rotation = new BABYLON.Vector3(0, Math.PI, 0);

            var multimat = new BABYLON.MultiMaterial("multi", scene);
            multimat.subMaterials.push(material0);
           
            box.material = multimat;
            sphere.material = multimat;
            sphere.subMeshes = [];
            var verticesCount = sphere.getTotalVertices();
            var indicesCount = sphere.getTotalIndices();
            new BABYLON.SubMesh(1, 0, verticesCount, 0, 5016, sphere);
            var material1 = new BABYLON.StandardMaterial("mat1", scene);
            material1.emissiveColor = new BABYLON.Color3(0, 0, 1);
            multimat.subMaterials.push(material1);
            var material2 = new BABYLON.StandardMaterial("mat2", scene);
            material2.diffuseColor = new BABYLON.Color3(0, 0, 1);
            multimat.subMaterials.push(material2);
            new BABYLON.SubMesh(0, 0, verticesCount, 5016, 8001, sphere);
            new BABYLON.SubMesh(2, 0, verticesCount, 13017, indicesCount-13017, sphere);
         
            var material_bottle = new BABYLON.StandardMaterial("bottle_image", scene);
           material_bottle.emissiveTexture = material_bottle.diffuseTexture = new BABYLON.Texture("https://upload.wikimedia.org/wikipedia/commons/f/fe/Az_girl_with_flowers._e-citizen.jpg", scene);

            BABYLON.SceneLoader.ImportMesh("", "assets/waterbottle/", "WaterBottle.gltf", scene, function (meshes, particleSystems, skeletons) {
          // do something with the meshes and skeletons
          // particleSystems are always null for glTF assets
               scene.activeCamera.alpha += Math.PI;
               meshes[0].scaling.scaleInPlace(10.0);
               meshes[0].rotate(BABYLON.Axis.Y, Math.PI / 3, BABYLON.Space.WORLD);
               meshes[0].material = material_bottle; 
            });
            return scene;
         };
         var scene = createScene();
         engine.runRenderLoop(function() {
            scene.render();
         });
        
      </script>
   </body>
</html>
